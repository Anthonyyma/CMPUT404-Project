{% extends 'base.html' %}
{% load static %}
{% load templatefunc %}
{% load markdownify %}

{% block head %}
<title>Public feed</title>
{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'css/feed.css' %}">
{% endblock %}

{% block content %}
    <div class="post-display">
        <div class="action-bar">
            <form action="/user/">
                <p class="text-center">View External User</p>
                <input type="text" name="url" placeholder="http://node.com/user">
                <button class='btn btn-primary' type="submit">Open</button>
            </form>
        </div>
        <div>
        <h2 class="text-center">Public Feed</h2>
        {% for post in posts %} 
        <div class="post">
            <div class="authorInfo">
                <img class="profilePic" src="{{user.profile_image.url}}"/><br>
                <h1 class="postAuthor">{{post.author.displayName}}</h1><br>
            </div>
            {% if post.contentType == 'text/markdown' %}
            <div>
                <a class="postTitle" href="{% url 'postContent' %}?url={{ post.id }}"><b>{{ post.title | markdownify }}</b></a><br>
                <div class="postContent">{{ post.content | markdownify }}</div>
            </div>
            {% elif post.contentType != 'image/png'%}  
            <a class="postTitle" href="{% url 'postContent' %}?url={{ post.id }}"><b>{{ post.title }}</b></a>
            {% else %}
            <a href="{% url 'postContent' %}?url={{ post.id }}"><b>{{ post.title }}</b><br>
            </a>
            {% endif %}
            {% if post.image %}
            <img class="contentImg" src="{{ post.image.url }}">
            {% endif %}
            <br>
            <a class="commentInfo" href="{% url 'postContent' %}?url={{ post.id }}">{{post.count}} comments</a>
        </div>
        {% endfor %}
        </div>
    </div>
{% endblock %}
